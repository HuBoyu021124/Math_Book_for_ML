## 5.8 线性近似和多元 Taylor 级数

函数 $f$ 的梯度 $\nabla f$ 通常用于 $f$ 在 $x_{0}$ 附近的局部线性近似：

$$f(x)\approx f(x_{0})+(\nabla_{x}f)(x_{0})(x - x_{0})$$

这里 $(\nabla_{x}f)(x_{0})$ 是 $f$ 关于 $x$ 的梯度，在 $x_{0}$ 处求值。图5.12说明了这种线性近似。原函数被一条直线近似，这种近似在局部是准确的，但随着我们远离 $x_{0}$ 而变差。方程(5.148)是 $f$ 在 $x_{0}$ 处多元 Taylor 级数展开的特例，其中我们只考虑前两项。

我们考虑一个在 $x_{0}$ 处光滑的函数 $f:\mathbb{R}^{D}\to \mathbb{R}$，$x\mapsto f(x)$，$x\in \mathbb{R}^{D}$。当我们定义差向量 $\delta :=x - x_{0}$ 时，$f$ 在 $(x_{0})$ 处的多元 Taylor 级数定义为

$$f(x)=\sum_{k = 0}^{\infty}\frac{D_{x}^{k}f(x_{0})}{k!}\delta^{k}$$

其中 $D_{x}^{k}f(x_{0})$ 是 $f$ 关于 $x$ 的第 $k$ 阶（全）导数，在 $x_{0}$ 处求值。

$f$ 在 $x_{0}$ 处的 $n$ 阶 Taylor 多项式包含(5.151)中级数的前 $n + 1$ 项，定义为

$$T_{n}(x)=\sum_{k = 0}^{n}\frac{D_{x}^{k}f(x_{0})}{k!}\delta^{k}$$

在(5.151)和(5.152)中，我们使用了略显草率的 $\delta^{k}$ 记号，这对于向量 $x\in \mathbb{R}^{D}$，$D>1$，和 $k>1$ 是未定义的。注意，$D_{x}^{k}f$ 和 $\delta^{k}$ 都是 $k$ 阶张量，即 $k$ 维数组。$k$ 阶张量 $\delta^{k}\in \mathbb{R}^{\overbrace{D\times D\times\cdots\times D}^{k times}}$ 是通过向量 $\delta\in \mathbb{R}^{D}$ 的 $k$ 重外积得到的，用 $\otimes$ 表示。例如，$\delta^{2}:=\delta\otimes\delta=\delta\delta^{\top}$，$\delta^{2}[i,j]=\delta[i]\delta[j]$ $\delta^{3}:=\delta\otimes\delta\otimes\delta$，$\delta^{3}[i,j,k]=\delta[i]\delta[j]\delta[k]$

我们写出 Taylor 级数展开的前几项 $D_{x}^{k}f(x_{0})\delta^{k}$，其中 $k = 0,\cdots,3$ 且 $\delta :=x - x_{0}$：

$k = 0: D_{x}^{0}f(x_{0})\delta^{0}=f(x_{0})\in \mathbb{R}$

$k = 1: D_{x}^{1}f(x_{0})\delta^{1}=\underbrace{\nabla_{x}f(x_{0})}{1\times D}\underbrace{\delta}{D\times 1}=\sum_{i = 1}^{D}\nabla_{x}f(x_{0})[i]\delta[i]\in \mathbb{R}$

$k = 2: D_{x}^{2}f(x_{0})\delta^{2}=tr(\underbrace{H(x_{0})}{D\times D}\underbrace{\delta}{D\times 1}\underbrace{\delta^{\top}}{1\times D})=\delta^{\top}H(x{0})\delta=\sum_{i = 1}^{D}\sum_{j = 1}^{D}H[i,j]\delta[i]\delta[j]\in \mathbb{R}$

$k = 3: D_{x}^{3}f(x_{0})\delta^{3}=\sum_{i = 1}^{D}\sum_{j = 1}^{D}\sum_{k = 1}^{D}D_{x}^{3}f(x_{0})[i,j,k]\delta[i]\delta[j]\delta[k]\in \mathbb{R}$ 这里，$H(x_{0})$ 是 $f$ 在 $x_{0}$ 处求值的 Hessian 矩阵

例5.15（两个变量函数的 Taylor 级数展开） 考虑函数 $f(x,y)=x^{2}+2xy + y^{3}$。我们要在 $(x_{0},y_{0})=(1,2)$ 处计算 $f$ 的 Taylor 级数展开。

在开始之前，让我们讨论一下我们的预期：(5.161)中的函数是一个3次多项式。我们正在寻找 Taylor 级数展开，它本身是多项式的线性组合。因此，我们不期望 Taylor 级数展开包含四阶或更高阶的项来表示一个三阶多项式。这意味着，确定(5.151)的前四项应该足以精确地表示(5.161)的另一种形式。

为了确定 Taylor 级数展开，我们从常数项和一阶导数开始：

$f(1,2)=13$

$\frac{\partial f}{\partial x}=2x + 2y\Rightarrow\frac{\partial f}{\partial x}(1,2)=6$

$\frac{\partial f}{\partial y}=2x + 3y^{2}\Rightarrow\frac{\partial f}{\partial y}(1,2)=14$ 因此，我们得到 $D_{x,y}^{1}f(1,2)=\nabla_{x,y}f(1,2)=\left[\begin{array}{ll}6&14\end{array}\right]\in \mathbb{R}^{1\times 2}$ 使得 $\frac{D_{x,y}^{1}f(1,2)}{1!}\delta=\left[\begin{array}{ll}6&14\end{array}\right]\left[\begin{array}{l}x - 1\y - 2\end{array}\right]=6(x - 1)+14(y - 2)$

二阶偏导数是：

当我们收集二阶偏导数时，我们得到 Hessian 矩阵 $H=\left[\begin{array}{ll}\frac{\partial^{2}f}{\partial x^{2}}&\frac{\partial^{2}f}{\partial x\partial y}\\frac{\partial^{2}f}{\partial y\partial x}&\frac{\partial^{2}f}{\partial y^{2}}\end{array}\right]=\left[\begin{array}{rr}2&2\2&6y\end{array}\right]$，因此 $H(1,2)=\left[\begin{array}{cc}2&2\2&12\end{array}\right]\in \mathbb{R}^{2\times2}$

因此， Taylor 级数展开的下一项由以下给出： $\frac{D_{x,y}^{2}f(1,2)}{2!}\delta^{2}=\frac{1}{2}\delta^{\top}H(1,2)\delta=\frac{1}{2}\left[\begin{array}{ll}x - 1&y - 2\end{array}\right]\left[\begin{array}{cc}2&2\2&12\end{array}\right]\left[\begin{array}{l}x - 1\y - 2\end{array}\right]=(x - 1)^{2}+2(x - 1)(y - 2)+6(y - 2)^{2}$

三阶导数获得为 $D_{x,y}^{3}f=\left[\begin{array}{ll}\frac{\partial H}{\partial x}&\frac{\partial H}{\partial y}\end{array}\right]\in \mathbb{R}^{2\times2\times2}$

$D_{x,y}^{3}f[:,:,1]=\frac{\partial H}{\partial x}=\left[\begin{array}{cc}\frac{\partial^{3}f}{\partial x^{3}}&\frac{\partial^{3}f}{\partial x^{2}y}\\frac{\partial^{3}f}{\partial x\partial y\partial x}&\frac{\partial^{3}f}{\partial x\partial y^{2}}\end{array}\right]$

$D_{x,y}^{3}f[:,:,2]=\frac{\partial H}{\partial y}=\left[\begin{array}{cc}\frac{\partial^{3}f}{\partial y\partial x^{2}}&\frac{\partial^{3}f}{\partial y\partial x\partial y}\\frac{\partial^{3}f}{\partial y^{2}\partial x}&\frac{\partial^{3}f}{\partial y^{3}}\end{array}\right]$

由于 Hessian 矩阵(5.171)中的大多数二阶偏导数是常数，唯一非零的三阶偏导数是 $\frac{\partial^{3}f}{\partial y^{3}}=6\Rightarrow\frac{\partial^{3}f}{\partial y^{3}}(1,2)=6$

更高阶导数和3阶混合导数（例如，$\frac{\partial f^{3}}{\partial x^{2}\partial y}$）消失，因此 $D_{x,y}^{3}f[:,:,1]=\left[\begin{array}{ll}0&0\0&0\end{array}\right]$, $D_{x,y}^{3}f[:,:,2]=\left[\begin{array}{ll}0&0\0&6\end{array}\right]$

且 $\frac{D_{x,y}^{3}f(1,2)}{3!}\delta^{3}=(y - 2)^{3}$

这收集了 Taylor 级数的所有三次项。

总的来说，$f$ 在 $(x_{0},y_{0})=(1,2)$ 处的（精确） Taylor 级数展开是

$$ \begin{align*} f(x)&=f(1,2)+D_{x,y}^{1}f(1,2)\delta+\frac{D_{x,y}^{2}f(1,2)}{2!}\delta^{2}+\frac{D_{x,y}^{3}f(1,2)}{3!}\delta^{3}\ &=f(1,2)+\frac{\partial f(1,2)}{\partial x}(x - 1)+\frac{\partial f(1,2)}{\partial y}(y - 2)\ &+\frac{1}{2!}\left(\frac{\partial^{2}f(1,2)}{\partial x^{2}}(x - 1)^{2}+\frac{\partial^{2}f(1,2)}{\partial y^{2}}(y - 2)^{2}+2\frac{\partial^{2}f(1,2)}{\partial x\partial y}(x - 1)(y - 2)\right)+\frac{1}{6}\frac{\partial^{3}f(1,2)}{\partial y^{3}}(y - 2)^{3}\ &=13+6(x - 1)+14(y - 2)\ &+(x - 1)^{2}+6(y - 2)^{2}+2(x - 1)(y - 2)+(y - 2)^{3} \end{align*} $$

在这种情况下，我们得到了(5.161)中多项式的精确 Taylor 级数展开，即(5.180c)中的多项式与(5.161)中的原始多项式完全相同。在这个特定的例子中，这个结果并不令人惊讶，因为原始函数是一个三阶多项式，我们通过常数项、一阶、二阶和三阶多项式的线性组合在(5.180c)中表达了它。