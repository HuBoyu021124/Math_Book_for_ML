## 7.1 基于梯度下降的优化
现在考虑求解一个实值函数最小值的问题：
$$
\min\limits_{\boldsymbol{x}}~f(\boldsymbol{x}), \tag{7.4}
$$
其中 $f: \mathbb{R}^{d} \rightarrow \mathbb{R}$ 是一个函数，它刻画了我们手中的机器学习问题。我们假设函数 $f$ 是可微的，并且我们无法找到上述问题的解析解。

梯度下降是一个一阶优化算法。它的每次迭代都将估计点做一个正比于函数在该点处的负梯度向量的移动，以逐步找到一个局部最小值点。
$$
\boldsymbol{x}_{1} = \boldsymbol{x}_{0} - \gamma \big[ (\nabla f)(\boldsymbol{x}_{0}) \big] ^{\top} \tag{7.5}
$$
$$
\boldsymbol{x}_{i+1} = \boldsymbol{x}_{i} - \gamma \big[ (\nabla f)(\boldsymbol{x}_{i}) \big] ^{\top} \tag{7.6}
$$
$$
f(\begin{bmatrix}
x_{1}\\x_{2}
\end{bmatrix}) = \frac{1}{2}\begin{bmatrix}
x_{1}\\x_{2}
\end{bmatrix}^{\top}\begin{bmatrix}
2&1\\1&20
\end{bmatrix}\begin{bmatrix}
x_{1}\\x_{2}
\end{bmatrix} - \begin{bmatrix}
5\\3
\end{bmatrix}^{\top}\begin{bmatrix}
x_{1}\\x_{2}
\end{bmatrix}\tag{7.7}
$$
$$
\nabla f(\begin{bmatrix}
x_{1}\\x_{2}
\end{bmatrix}) = \begin{bmatrix}
x_{1}\\x_{2}
\end{bmatrix}^{\top}\begin{bmatrix}
2&1\\1&20
\end{bmatrix} - \begin{bmatrix}
5\\3
\end{bmatrix}^{\top}\tag{7.8}
$$

### 7.1.1
$$
\| \boldsymbol{A}\boldsymbol{x} - \boldsymbol{b} \| ^{2} = (\boldsymbol{A}\boldsymbol{x} - \boldsymbol{b})^{\top}(\boldsymbol{A}\boldsymbol{x} - \boldsymbol{b})\tag{7.9}
$$
$$
\nabla_{\boldsymbol{x}} = 2(\boldsymbol{A}\boldsymbol{x} - \boldsymbol{b})^{\top}\boldsymbol{A}. \tag{7.10}
$$

### 7.1.2
$$
\begin{align}
\boldsymbol{x}_{i+1} &= \boldsymbol{x}_{i} - \gamma_{i} \big[ (\nabla f)(\boldsymbol{x}_{i}) \big] ^{\top} + \alpha\Delta \boldsymbol{x}_{i} \tag{7.11}\\
\Delta \boldsymbol{x}_{i} &= \boldsymbol{x}_{i} - \boldsymbol{x}_{i-1} = \alpha\Delta \boldsymbol{x}_{i-1} - \gamma_{i-1}\big[ (\nabla f)(\boldsymbol{x}_{i-1}) \big] ^{\top}, \tag{7.12}
\end{align}
$$

### 7.1.3
$$
L(\boldsymbol{\theta}) = \sum\limits_{n=1}^{N} L_{n}(\boldsymbol{\theta})\tag{7.13}
$$
$$
L(\boldsymbol{\theta}) = -\sum\limits_{n=1}^{N} \log p(y_{n}|\boldsymbol{x}_{n}, \boldsymbol{\theta}) \tag{7.14}
$$
$$
\boldsymbol{\theta}_{i+1} + \boldsymbol{\theta}_{i} = \gamma_{i}\big[ \nabla L(\boldsymbol{\theta}_{i}) \big] ^{\top} = \boldsymbol{\theta}_{i} - \gamma_{i}\sum\limits_{n=1}^{N} \big[ \nabla L_{n}(\boldsymbol{\theta}_{i}) \big] ^{\top}\tag{7.15}
$$
